DXR
---

Introduction:
-------------

DXR is a source code cross-reference tool that uses static analysis data
collected by instrumented compilers.  DXR was created in order to build on
tools like LXR and MXR.  DXR only runs on Linux for the moment.

Prerequisites:
--------------

You need a copy of python, python-sqlite, and sqlite3. If you want to use the
output HTML, you will need a web-server of some kind. Individual tools have
further requirements:

cxx-clang: A copy of clang.

Furthermore, glimpse is needed to do fulltext indexing.

Setup:
------

DXR is primarily a database of source code information.  You need a lot of
space to do this, and a fast computer helps a lot.

1) DXR uses config info from an INI style config file. Alter the variables in
dxrsrc/www/dxr.config for your environment.

2) For the moment, you need to alter dxrsrc/xref-tools/cxx-clang/dxr-index.cpp
for your source directory:
return filename.find("/src/dxr/") == 0;

3) Create the wwwdir (e.g., /var/www/html/dxr) you specified in your dxr.config

4) Copy (or symlink) the contents of dxrsrc/www to your web dir. You also need
to copy (or symlink) the xref-scripts directory.

5) Run . dxrsrc/setup-env.sh to set up your environment. The single `.' at the
beginning is very important; otherwise, your shell will not have the necessary
variables exported.

6) Compile and build your program. It is recommended that you use a separate
build directory from your source directory.

6a) Run $DXRSRC/post-process.py /path/to/srcdir > master.sql from your build
directory. This is a temporary step while I work with the build system.

7) Run the cross-reference generator:
dxrsrc/xref-scripts/run-dxr.py -f /path/to/web/dir/dxr.config

8) Download and install (or at least build somewhere the web app can access) Glimpse:

http://webglimpse.net/trial/glimpse-latest.tar.gz

9) You can optionally install sqlite 3 if it is not already installed on your system.  You don't strictly need it, but it makes accessing the database manually eaiser.

Running:
-------

You can build your source, create the xref database, and create the static HTML content as follows:

dxrsrc/xref-scripts/run-dxr.py -f /path/to/web/dir/dxr.config

This will post-process the data into dxr.sqlite.  It will also build the static
html and create a glimpse full-text search index.  All these files will be
created in the wwwdir using the name of the tree you provided in dxr.config
(e.g., mozilla-central).  You will end up with the following structure:

/var/www/html/dxr (or whereever your wwwdir is located)
		 /index.html (auto-generated during run-dxr.py)
                 /mozilla-central (symlink to mozilla-central-current)
                 /mozilla-central-current
		                         /.dxr_xref
                                                   /mozilla-central.sqlite
                                                   /.glimpse*  (glimpse index files)
                                         /accessible (and all other source files copied from your src dir)
