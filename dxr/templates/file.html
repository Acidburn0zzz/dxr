{% extends "layout.html" %}

{% block title %}{{ name }} - DXR{% endblock %}

{% block head %}
  <link rel="shortcut icon" href="{{ wwwroot }}/static/icons/{{ icon }}.png"/>
  <script src="{{ wwwroot }}/static/menu.js"></script>
  <script src="{{ wwwroot }}/static/file.js"></script>
  <script src="{{ wwwroot }}/static/panel.js"></script>
{% endblock %}

{% set panel = True %}
{% set state_eof = True %}

{% block panel %}
  {% for section, items in sections %}
  <div class="section">
    <h1>{{ section }}</h1>
    {% for icon, title, href in items %}
      <a href="{{ href }}"
        title="{{ title }}"
        style="background-image: url('{{ wwwroot }}/static/icons/{{ icon }}.png');"
        >{{ title }}</a>
    {%- endfor %}
    </div>
  {% endfor %}
{% endblock %}

{% block content %}
<div id="content" class="content" data-no-results="No results returned for current query.">
  <p class="file-name">
    {%- for path, name in paths_and_names -%}
      {% if not loop.first or loop.last %}
        <span class="path-separator">/</span><a href="{{ wwwroot }}{{ path }}">{{ name }}</a>
      {% else %}
        <a href="{{ wwwroot }}{{ path }}">{{ name }}</a>
      {% endif %}
    {%- endfor -%}
  </p>

  {% set showing_tree_menu = trees|length > 1 %}
  {% if showing_tree_menu %}
    <section id="tree-selector" class="tree-selector">
      <select name="tree" id="tree">
        {% for t in trees %}
          <option{% if ((t == tree) if tree else loop.first)  %} selected="selected"{% endif %}>{{ t }}</option>
        {% endfor %}
      </select>
    </section>
  {% else %}
    <section id="tree-selector" class="tree-selector">
      <select name="tree" id="tree" disabled="disabled">
        <option value="{{ tree }}">{{ tree }}</option>
      </select>
    </section>
  {% endif %}

  <div id="annotations">
    {% for line, annotations in lines %}
      <div class="annotation-set" id="aset-{{ loop.index }}">
        {%- for annotation in annotations -%}
          <div {% for key, value in annotation.items() %}
                {{ key }}="{{ value }}"
               {% endfor %} ></div>
        {%- endfor -%}
      </div>
    {%- endfor -%}
  </div>

  <table class="result_snippet file">
    <thead class="visually-hidden">
        <th scope="col">Line</th>
        <th scope="col">Code</th>
    </thead>
    <tbody>
    {% for line, annotations in lines %}
      <tr>
          <td>
            <a href="#l{{ loop.index }}" id="l{{ loop.index }}">{{ loop.index }}</a>
          </td>
          <td class="code">
<pre>
<code aria-labelledby="l{{ loop.index }}">{{ line }}</code>
</pre>
          </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
   <p class="top"><a href="#search-box">Back to Top</a></p>
 </div>
{% endblock %}
